{% extends "base.html" %}

{% block title %}Kefi {{name}}{% endblock %}

{% block content %}

<div class='container'>
	<div class="jumbotron" style="background-color:rgb({{color}}); font-family:'Roboto', sans-serif;">
		<p class="jumboTitle whiteText" align="center">{{name}}</p>
		<!--<div class='intro'>-->
		<div class = 'introInfo whiteText'>
			<div  align="center">{{venueTypes}}</div>

			<br/>
			<div class='left introInfo'>
				{% for addresses in address %}
					{{ addresses }}
					{%if not forloop.last %}<br/> {% endif %}
				{% endfor %}
			</div>
		</div>
		<div class='introInfoRight'>
			<div style="float:right;"><a class="noDecoration whiteText" href="http://foursquare.com/v/{{id}}?ref=T4XPWMEQAID11W0CSQLCP2P0NXGEUSDZRV4COSBJH2QEMC2O">4Square Page</div>
			
		</div>
	<!--</div>-->

		<br/>
	  	<div class='btn-group buttonsPlaceDetail' style='width:100%'>
			<a href="/review/{{ name }}/{{ id }}"><button type='button' class='btn btn-default buttonPlaceDetail'><span class="glyphicon glyphicon-edit"></span><p style="font-size: 10px;">Tag it</p></button></a>
			
			{% if placeFavorited %}
				<a href="/{{ name }}/{{ id }}/fav"><button type='button' class='btn btn-info buttonPlaceDetail active'><span class="glyphicon glyphicon-star"></span><p style="font-size: 10px;">Fav</p></button></a>
			{% else %}
				<a href="/{{ name }}/{{ id }}/fav"><button type='button' class='btn btn-default buttonPlaceDetail'><span class="glyphicon glyphicon-star"></span><p style="font-size: 10px;">Fav</p></button></a>
			{% endif %}

		</div>
		 <!--
		  <button type='button' class='btn btn-lg btn-default'><a href="#"><span class="glyphicon glyphicon-map-marker"><
		{%else}/span></a></button>
		 -->
	  
	  <!--short menu to write review, see more history, favorite, etc.-->
	</div>

	<br/>
	<div class="curTags">
		{% if tagsWithFonts %}
		
			{% for tag,fontSize,freq,username, wasTagged in tagsWithFonts %}
			<div class="tagNode">
				<span class="tagText" style="font-size:{{fontSize}}%; font-family:'Roboto', sans-serif;" id="{{tag}}">
					#{{tag}}
					<span class="freqTag" style="font-size:40%;" >({{freq}}x)</span>

					{% if wasTagged %}
						<span class="didUserTag glyphicon glyphicon-ok freqTag"></span>
					{% else %}
						<span class="didUserTag glyphicon glyphicon-ok freqTag hidden"></span>

					{% endif %}
				</span>
					
				<div class='tagUsername'>
					{% if username == "Kefi" %}
						<span class="username freqTag" id="{{username}}" >{{username}}</span>
					{%else%}
						<span class="username kefiTag" id="{{username}}">{{username}}</span>
					{%endif%}
				</div>		
			</div>
			{% endfor %}
		

		{%elif oldTags %}
			<!--<div class='h4'>Are you here? <a href="/review/{{ name }}/{{ id }}">Get the party started!</a></div>
			</br><br/>-->
			<h4 id='titleOldTags'>What happened here lately?</h4>
			{% for tag in oldTags %}
				<p style="font-size:16px; font-family:'Roboto', sans-serif;">#{{tag}}</p>
			{%endfor%}

		{% else%}
			<p> There are no tags for this Venue!</p>
			<p><a href="/review/{{ name }}/{{ id }}">Be the first to review this place!</a></p>
		{% endif %}
	</div>
	
	<br/><br/>


	<!--Comments-->
	<!--
	<div class='placeComments'>
		{% if comments %}
		<h4>Tag Wall:</h4>
		<table class='commentsTable'>
			{% for comment,timestamp in comments%}
				<tr>
					<td><p class='commentUser'>{{comment.User.user.username}}</p></td>
					 <td><p class='commentTimestamp'>{{timestamp}}</p></td>
				</tr>
				<tr >
					<td colspan="2">
						<p class='commentText'> {{comment.comment}}</p></td>
				</tr>
				
			{%endfor%}
		</table>
		{% endif %}

	</div>
	-->
</div>


<!--modal-->
{% include "places/tagSelect.html" %}

<!--yelp button-->
<!--<div class='right' style="width:95%; position:relative; margin-top:3em;"><img src="http://s3-media1.ak.yelpcdn.com/assets/2/www/img/1589098a542f/developers/Powered_By_Yelp_White.png"></div>-->

<script  type = "text/javascript">
	var loadingState = '<div id="ballsWaveG"><div id="ballsWaveG_1" class="ballsWaveG"></div><div id="ballsWaveG_2" class="ballsWaveG"></div><div id="ballsWaveG_3" class="ballsWaveG"></div><div id="ballsWaveG_4" class="ballsWaveG"></div><div id="ballsWaveG_5" class="ballsWaveG"></div><div id="ballsWaveG_6" class="ballsWaveG"></div><div id="ballsWaveG_7" class="ballsWaveG"></div><div id="ballsWaveG_8" class="ballsWaveG"></div></div>';

	$(document).ready(function() {

		$('.tag').click(function() {
			if ($(this).hasClass('inactiveTag'))
			{
				$(this).css('background-color','#c0c0c0');
				location.href='/tag/' + $(this).attr('id');
			}
		});


		$(document).on(" touchend",".tagText", function() {
			//pass different information
			if ($(".userName").attr("id") == "1")
			{
				tagText = $(this).attr("id");
				var place = "{{id}}";

				if ($(this).parent().find(".username").attr("id") =="Kefi") {
					$(this).parent().html(loadingState).load("/placeTagUpdate?tagText=" + tagText + "&place=" + place);
				}

				else {
					$(this).parent().html(loadingState).load("/userTagUpdate?tagText=" + tagText + "&place=" + place);
				}
			}

			else	
			{
				alert('uh oh! Please login to quickTag this place!');
			}
		});
	});
</script>
{% endblock %}